(()=>{"use strict";const t=250;class s{constructor(t,s,i){this.t=t,this.i=s,this.color=i,this.o=[],this.h()}h(){const{t,i:s,color:e}=this,o=Math.atan2(s.y-t.y,s.x-t.x),h=Math.hypot(s.x-t.x,s.y-t.y);for(let s=0;s<Math.ceil(h/n);s++){const h=t.x+Math.cos(o)*s*n,c=t.y+Math.sin(o)*s*n;this.o.push(new i(h,c,e,o))}this.angle=o}reset(){this.o=[],this.h()}update(){for(let t=0;t<this.o.length;t++)this.o[t].l<=0||this.o[t].update()}draw(t){for(let s=0;s<this.o.length;s++)this.o[s].l<=0||this.o[s].draw(t)}}class i{constructor(t,s,i,n){this.color=i,this.u={x:t,y:s},this.M={x:0,y:0},this.color=i,this.l=100,this.angle=n}update(){this.u.x+=this.M.x,this.u.y+=this.M.y,this.l--}draw(t){this.left<0||(this.l<75?t.fillStyle=`rgba(${this.color}, ${this.l/75})`:t.fillStyle=`rgba(${this.color}, 1)`,t.beginPath(),t.rect(this.u.x-n/2,this.u.y,n,n),t.fill(),t.closePath())}}const n=20,e="255,255,255";class o{constructor(t,s,i,o,h=!0,c=!0){this.width=n,this.u={x:0,y:0},this.t={x:0,y:0},this.i={x:0,y:0},this.p={x:0,y:0},this.m={x:0,y:0},this.C=!1,this.v=h,this.B=c,this.color=h?e:"0,0,0",this.j(t,s,i,o)}j(t,s,i,n){this.t.x=t,this.t.y=s,this.i.x=i,this.i.y=n;const{t:e,i:o}=this;this.u.x=(e.x+o.x)/2,this.u.y=(e.y+o.y)/2,this.angle=Math.atan2(o.y-e.y,o.x-e.x)-Math.PI/2,this.k=this.F(e,o,this.width),this.A=this.$();const h=6*Math.sin(this.angle),c=6*-Math.cos(this.angle);this.p.x=this.t.x-h,this.p.y=this.t.y-c,this.m.x=this.i.x+h,this.m.y=this.i.y+c,this.D()}update(){this.C&&this.P.update()}D(){this.P=new s(this.t,this.i,this.color)}reset(){this.C=!1,this.P.reset()}I(t){this.C=!0,this.P.o.forEach((s=>{const i=Math.random()*Math.PI*2;s.M.x=t*(2*Math.random()-1)*Math.cos(i),s.M.y=t*(2*Math.random()-1)*Math.sin(i)}))}F(t,s,i){const n=i/2,e=Math.sqrt((s.x-t.x)**2+(s.y-t.y)**2)/2,o=this.angle;return[{x:-n,y:-e},{x:-n,y:e},{x:n,y:e},{x:n,y:-e}].map((t=>({x:this.u.x+(t.x*Math.cos(o)-t.y*Math.sin(o)),y:this.u.y+(t.x*Math.sin(o)+t.y*Math.cos(o))})))}$(){const t=[],s=this.k,i=s.length;for(let n=0;n<i;n++){const e=(n+1)%i,o=s[e].x-s[n].x,h=s[e].y-s[n].y,c=Math.sqrt(o*o+h*h),a={x:-h/c,y:o/c};t.push(a)}return t}S(t){let s=Number.POSITIVE_INFINITY,i=-Number.POSITIVE_INFINITY;for(let n=0;n<this.k.length;n++){let e=this.k[n].x*t.x+this.k[n].y*t.y;s=Math.min(s,e),i=Math.max(i,e)}return{min:s,max:i}}N(t,s,i,n,e){const o=t-i,h=s-n;return o*o+h*h<=e*e}T(t,s){return this.H(t,s)}H(t,s){let i=!1;const n=this.k,e=n.length;for(let o=0,h=e-1;o<e;h=o++){const e=n[o].x,c=n[o].y,a=n[h].x,l=n[h].y;c>s!=l>s&&t<(a-e)*(s-c)/(l-c)+e&&(i=!i)}return i}J(t,s){return this.V(t,s)?this.t:this.W(t,s)?this.i:null}V(t,s){return this.N(t,s,this.p.x,this.p.y,15)}W(t,s){return this.N(t,s,this.m.x,this.m.y,15)}L(t,s){return this.v?this.N(t,s,this.u.x,this.u.y,15):null}draw(t){this.C?this.P.draw(t):this.B?this.O(t):this.U(t)}O(t){t.beginPath(),t.setLineDash([]),t.fillStyle=`rgba(${this.color}, 1.0)`,t.strokeStyle="#000",t.lineWidth=2,t.moveTo(this.k[0].x,this.k[0].y);for(let s=1;s<this.k.length;s++)t.lineTo(this.k[s].x,this.k[s].y);t.closePath(),t.fill(),t.stroke(),this.color===e&&(t.beginPath(),t.lineWidth=2,t.strokeStyle="red",t.moveTo(this.u.x-5,this.u.y-5),t.lineTo(this.u.x+5,this.u.y+5),t.moveTo(this.u.x-5,this.u.y+5),t.lineTo(this.u.x+5,this.u.y-5),t.stroke(),t.closePath(),t.beginPath(),t.fillStyle="rgba(255, 0, 0, 1.0)",t.arc(this.p.x,this.p.y,4,0,2*Math.PI),t.arc(this.m.x,this.m.y,4,0,2*Math.PI),t.fill())}U(t){t.beginPath(),t.fillStyle=`rgba(${this.color}, 0.60)`,t.strokeStyle="#000",t.lineWidth=2,t.moveTo(this.k[0].x,this.k[0].y);for(let s=1;s<this.k.length;s++)t.lineTo(this.k[s].x,this.k[s].y);t.closePath(),t.setLineDash([5,5]),t.stroke(),t.fill(),this.color===e&&(t.beginPath(),t.lineWidth=2,t.strokeStyle="red",t.setLineDash([]),t.moveTo(this.u.x-5,this.u.y-5),t.lineTo(this.u.x+5,this.u.y+5),t.moveTo(this.u.x-5,this.u.y+5),t.lineTo(this.u.x+5,this.u.y-5),t.stroke(),t.closePath(),t.beginPath(),t.fillStyle="rgba(255, 0, 0, 1.0)",t.arc(this.p.x,this.p.y,4,0,2*Math.PI),t.arc(this.m.x,this.m.y,4,0,2*Math.PI),t.fill()),t.setLineDash([])}}class h{constructor(t=0,s=0,i=0,n=1){this.q={x:t,y:s},this.angle=i,this.R=n,this.G={x:t,y:s}}get K(){return this.G.x=this.q.x+this.R*Math.cos(this.angle),this.G.y=this.q.y+this.R*Math.sin(this.angle),this.G}}class c{constructor(){this.k=[]}}function a(t,s){return t.max>s.min&&s.max>t.min}function l(t,s){return Math.min(t.max-s.min,s.max-t.min)}function r(t,s){let i=Number.POSITIVE_INFINITY,n=null,e=null;for(let o=0;o<s.A.length;o++){const h=s.A[o],c=s.S(h),r=t.S(h);if(!a(c,r))return null;{const t=l(c,r);t<i&&(i=t,n=h,e=s.k[o])}}for(const o of s.k){const h={x:t.u.x-o.x,y:t.u.y-o.y},c=Math.sqrt(h.x*h.x+h.y*h.y);if(0===c)continue;h.x/=c,h.y/=c;const r=s.S(h),u=t.S(h);if(!a(r,u))return null;{const t=l(r,u);t<i&&(i=t,n=h,e=o)}}if(i===Number.POSITIVE_INFINITY)return null;let o=t.u.x-e.x,h=t.u.y-e.y;return o*n.x+h*n.y<0&&(n.x=-n.x,n.y=-n.y),{X:{x:n.x*i,y:n.y*i},axis:n}}class u{Y=1;constructor(t,s,i=0,n=8){this.Z=n,this.color="#fff",this.u={x:t,y:s},this._={x:t,y:s},this.M={x:0,y:0},this.tt=null,this.Y=n,this.st=i,this.u.x=t,this.u.y=s,this.alpha=1,this.it=!1,this.nt=0}S(t){const s=this.u.x*t.x+this.u.y*t.y;return{min:s-this.Z,max:s+this.Z}}update(){const t=.98-this.nt;this.M.x*=t,this.M.y*=t,Math.abs(this.M.x)<.01&&(this.M.x=0),Math.abs(this.M.y)<.01&&(this.M.y=0),this.u.x+=this.M.x,this.u.y+=this.M.y}reset(){this.u.x=this._.x,this.u.y=this._.y,this.tt=null,this.M.x=0,this.M.y=0,this.it=!1,this.alpha=1}}class d{tt=null;constructor(t,s,i=15,n="black"){this.u={x:t,y:s},this.Z=i,this.color=n}}class f{et=[];ot=[];ht=[];ct=[];lt=!1;backgroundColor="red";rt="red";ut="red";dt="red";ft="#ffffff";width=500;height=500;wt=!1;reset(){this.wt=!1,this.lt=!1,this.et.forEach((t=>{t.reset()})),this.ot.forEach((t=>{t.reset()})),document.getElementById("js-place-wall").classList.remove("disabled"),document.getElementById("js-place-wall").setAttribute("disabled",!1),document.body.style.backgroundColor=this.rt}get Mt(){for(let t=0;t<this.et.length;t++)if(!this.et[t].tt)return!1;return!0}}class w extends f{backgroundColor="#B4E7CE";rt="#59A96A";ut="#9BDEAC";dt="#474A2C";constructor(){super(),this.ht=[new d(400,250)],this.et=[new u(250,250)]}}class M extends f{backgroundColor="#BB8A89";rt="#977390";ut="#AC7B7D";dt="#785589";constructor(){super(),this.ht=[new d(400,125),new d(400,375)],this.et=[new u(250,125),new u(250,375)]}}class p extends f{backgroundColor="#F4F4F9";rt="#586F7C";ut="#B8DBD9";dt="#2F4550";constructor(){super(),this.ht=[new d(100,125),new d(400,375)],this.et=[new u(250,125),new u(250,375,Math.PI)]}}class m extends f{backgroundColor="#AFB3F7";rt="#7A93AC";ut="#92BCEA";dt="#617073";constructor(){super(),this.ht=[new d(400,125),new d(400,375)],this.et=[new u(50,125),new u(250,375,Math.PI)],this.ot=[new o(100,50,100,200,!1)]}}class b extends f{backgroundColor="#FEC0AA";rt="#84732B";ut="#EC4E20";dt="#574F2A";constructor(){super(),this.ht=[new d(400,125),new d(400,375)],this.et=[new u(150,125),new u(250,375,Math.PI)],this.ot=[new o(25,0,25,500,!1),new o(475,0,475,500,!1)]}}class C extends f{backgroundColor="#F2F6D0";rt="#D9D2B6";ut="#D0E1D4";dt="#71697A";constructor(){super(),this.ht=[new d(250,150),new d(100,350),new d(400,350)];const t=[{x:100,y:200},{x:400,y:200},{x:250,y:400}],s=(t[0].x+t[1].x+t[2].x)/3,i=(t[0].y+t[1].y+t[2].y)/3,n=(t,n)=>Math.atan2(i-n,s-t);this.et=[new u(t[0].x,t[0].y,n(100,200)),new u(t[1].x,t[1].y,n(400,200)),new u(t[2].x,t[2].y,n(250,400))],this.ot=[]}}class x extends f{backgroundColor="#FAA275";rt="#CE6A85";ut="#FF8C61";dt="#985277";constructor(){super(),this.ht=[new d(150,400),new d(250,400),new d(350,400)],this.et=[new u(150,150),new u(250,200),new u(350,250)],this.ot=[]}}class v extends f{backgroundColor="#BEEF9E";rt="#828C51";ut="#A6C36F";dt="#335145";constructor(){super(),this.ht=[new d(250,250)];this.et=[new u(400,250,0),new u(250+150*Math.cos(Math.PI),250+150*Math.sin(Math.PI),Math.PI)]}}class B extends f{backgroundColor="#CF9893";rt="#A96DA3";ut="#BC7C9C";dt="#3B3B58";constructor(){super(),this.ht=[new d(250,300),new d(200,250)],this.et=[new u(250,200,0),new u(300,250,-Math.PI/2)],this.ot=[new o(200,200,300,300,!1),new o(300,200,200,300,!1)]}}class g extends f{backgroundColor="#FFA9E7";rt="#7F2CCB";ut="#FF84E8";dt="#414361";constructor(){super(),this.ht=[new d(200,200),new d(400,400)],this.et=[new u(250,250,0),new u(300,300,Math.PI/2)],this.ot=[new o(100,200,200,100,!1)]}}const j=.25,y=.15,k=2,F=document.getElementById("canvas"),A=F.getContext("2d"),E={wt:1,B:2,bt:4,Ct:8,xt:16,vt:18,Bt:32,gt:22};let $={jt:null,yt:null,kt:null,inputMode:E.wt,Ft:E.wt,At:"",Et:""};function D(){const t=window.innerWidth/F.width,s=window.innerHeight/F.height;return Math.min(t,s)}$.$t=document.getElementById("game-ui"),$.title=document.getElementById("title-container"),$.Dt=document.getElementById("hole-number"),$.Pt=document.getElementById("canvas-container"),$.It=document.getElementById("js-prev"),$.St=document.getElementById("js-next"),document.getElementById("js-hit-ball").addEventListener("click",(t=>{t.preventDefault(),t.currentTarget.classList.contains("disabled")||($.inputMode=E.wt,t.currentTarget.classList.add("active"),document.getElementById("js-place-wall").classList.remove("active"),document.getElementById("js-place-bump").classList.remove("active"),document.getElementById("js-hit-ball").style.boxShadow=`0 2px ${T.dt}`,document.getElementById("js-place-wall").style.boxShadow=`0 5px ${T.dt}`,document.getElementById("js-place-bump").style.boxShadow=`0 5px ${T.dt}`)})),document.getElementById("js-place-wall").addEventListener("click",(t=>{t.preventDefault(),t.currentTarget.classList.contains("disabled")||($.inputMode=E.B,t.currentTarget.classList.add("active"),document.getElementById("js-hit-ball").classList.remove("active"),document.getElementById("js-place-bump").classList.remove("active"),document.getElementById("js-hit-ball").style.boxShadow=`0 5px ${T.dt}`,document.getElementById("js-place-wall").style.boxShadow=`0 2px ${T.dt}`,document.getElementById("js-place-bump").style.boxShadow=`0 5px ${T.dt}`)})),document.getElementById("js-place-bump").addEventListener("click",(t=>{t.preventDefault(),t.currentTarget.classList.contains("disabled")||($.inputMode=E.xt,t.currentTarget.classList.add("active"),document.getElementById("js-hit-ball").classList.remove("active"),document.getElementById("js-place-wall").classList.remove("active"),document.getElementById("js-hit-ball").style.boxShadow=`0 5px ${T.dt}`,document.getElementById("js-place-wall").style.boxShadow=`0 5px ${T.dt}`,document.getElementById("js-place-bump").style.boxShadow=`0 2px ${T.dt}`)})),document.getElementById("js-reset").addEventListener("click",(t=>{t.preventDefault(),Mt(),ct()})),$.It.addEventListener("click",(t=>{t.preventDefault(),t.currentTarget.classList.contains("disabled")||ht(S)})),$.St.addEventListener("click",(t=>{t.preventDefault(),t.currentTarget.classList.contains("disabled")||ht(S+2)}));const P=new o(0,0,0,0,!0,!0),I=[new w,new M,new p,new m,new b,new C,new x,new v,new B,new g];let S=0,N=(S+1)%I.length,T=I[S];T.reset();let H=I[N];const J=[],V=Math.hypot(F.width,F.height)/2;let W=V;const z=5,L=new class{constructor(t,s,i,n){this.canvas=t,this.Nt=s,this.Tt=i,this.Ht=n,this.Jt={x:0,y:0},this.Vt={x:0,y:0},this.Wt={x:0,y:0},this.zt={x:0,y:0},this.pressed=!1,this.boundingRect=this.canvas.getBoundingClientRect(),this.Lt(this.canvas)}resize(){this.boundingRect=this.canvas.getBoundingClientRect()}Lt(t){t.addEventListener("mousedown",this.Ot.bind(this),{capture:!0,passive:!1}),window.addEventListener("mousemove",this.Ut.bind(this),{capture:!0,passive:!1}),window.addEventListener("mouseup",this.qt.bind(this),{capture:!0,passive:!1}),t.addEventListener("touchstart",this.Qt.bind(this),{capture:!0,passive:!1}),window.addEventListener("touchend",this.qt.bind(this),{capture:!0,passive:!1}),window.addEventListener("touchmove",this.Rt.bind(this),{capture:!0,passive:!1}),window.addEventListener("touchcancel",this.qt.bind(this),{capture:!0,passive:!1})}Gt(){this.Wt.x=(this.Vt.x-this.Jt.x)/t,this.Wt.y=(this.Jt.y-this.Vt.y)/t}Kt(t){const s=canvas.getBoundingClientRect();let i,n;if(t instanceof MouseEvent)i=t.clientX-s.left,n=t.clientY-s.top;else if(t instanceof TouchEvent){const t=event.touches[0];i=t.clientX-s.left,n=t.clientY-s.top}i*=canvas.width/s.width,n*=canvas.height/s.height,this.zt.x=i,this.zt.y=n}Xt(t){let s=0;return t instanceof MouseEvent?s=t.clientX:t instanceof TouchEvent&&(s=t.changedTouches[0].clientX),(s-this.boundingRect.left)*(this.canvas.width/this.boundingRect.width)}Yt(t){let s=0;return t instanceof MouseEvent?s=t.clientY:t instanceof TouchEvent&&(s=t.changedTouches[0].clientY),(s-this.boundingRect.top)*(this.canvas.height/this.boundingRect.height)}Qt(t){t.preventDefault(),this.Kt(t),this.Zt(this.Xt(t),this.Yt(t))}Rt(t){t.preventDefault(),this.Kt(t),this._t(this.Xt(t),this.Yt(t)),console.log(this.pressed)}Ot(t){t.preventDefault(),this.Kt(t),this.Zt(this.Xt(t),this.Yt(t))}Ut(t){t.preventDefault(),this.Kt(t),this._t(this.Xt(t),this.Yt(t))}Zt(t,s){this.pressed=!0,this.Jt.x=t,this.Jt.y=s,this.Vt.x=t,this.Vt.y=s,this.Gt(),this.Nt()}_t(s,i){if(!this.pressed)return;const n=s-this.Jt.x,e=i-this.Jt.y,o=Math.hypot(n,e);if(this.Vt.x=s,this.Vt.y=i,o>t){const s=n/o*t,i=e/o*t;this.Vt.x=this.Jt.x+s,this.Vt.y=this.Jt.y+i}this.Gt(),this.Ht()}qt(t){0!=this.pressed&&(t.preventDefault(),t.stopPropagation(),this.pressed=!1,this.Jt.x=0,this.Jt.y=0,this.Vt.x=0,this.Vt.y=0,this.Gt(),this.Tt())}draw(t){this.pressed&&(this.ts(t),this.ss(t))}ts(s){s.strokeStyle="#FFD700",s.lineWidth=6,s.beginPath(),s.arc(this.Jt.x,this.Jt.y,t,0,2*Math.PI),s.stroke(),s.closePath()}ss(t){t.strokeStyle="#F0E68C",t.lineWidth=6,t.beginPath(),t.arc(this.Vt.x,this.Vt.y,125,0,2*Math.PI),t.fillStyle="#F0E68C",t.globalAlpha=.5,t.fill(),t.globalAlpha=1,t.closePath()}}(F,(function(){$.title.style.opacity=0;for(let t=0;t<T.ot.length;t++){const s=T.ot[t];if(!s.v)continue;const i=s.J(L.zt.x,L.zt.y);if(s.L(L.zt.x,L.zt.y))return void T.ot.splice(t,1);if(i)return $.Ft=$.inputMode,$.inputMode=E.bt,$.yt=s,void($.kt=i);s.T(L.zt.x,L.zt.y)&&($.Ft=$.inputMode,$.inputMode=E.Ct,$.yt=s,$.kt=null)}for(let t=0;t<T.ct.length;t++){const s=T.ct[t];if(!s.v)continue;const i=s.J(L.zt.x,L.zt.y);if(s.L(L.zt.x,L.zt.y))return void T.ct.splice(t,1);if(i)return $.Ft=$.inputMode,$.inputMode=E.bt,$.yt=s,void($.kt=i);s.T(L.zt.x,L.zt.y)&&($.Ft=$.inputMode,$.inputMode=E.Ct,$.yt=s,$.kt=null)}$.inputMode===E.wt?function(){J.length=0;for(let t=0;t<T.et.length;t++){const s=T.et[t];J.push(new h(s.u.x,s.u.y,L.Wt.x,L.Wt.y))}}():$.inputMode&E.vt&&O.k.push({x:L.zt.x,y:L.zt.y})}),(function(){$.inputMode===E.wt?function(){if(0===J.length)return;for(let t=0;t<T.et.length;t++){const s=T.et[t];if(s.tt)continue;const i=J[t],n=Math.cos(i.angle)*i.R*.05,e=Math.sin(i.angle)*i.R*.05;s.M.x=n,s.M.y=e}J.length=0,T.wt=!0,$.inputMode=E.Bt,F.style.cursor="not-allowed",document.getElementById("js-hit-ball").classList.add("disabled"),document.getElementById("js-place-wall").classList.add("disabled"),document.getElementById("js-place-bump").classList.add("disabled"),$.St.classList.add("disabled"),$.It.classList.add("disabled");const t=document.getElementById("js-reset");t.classList.remove("disabled"),Array.from(document.getElementsByClassName("button")).forEach((t=>{"js-reset"!==t.id&&(t.style.backgroundColor=null,t.style.boxShadow=null)})),t.style.backgroundColor=T.ut,t.style.boxShadow=`0 5px ${T.dt}`,t.style.color=wt(...ft(T.ut))}():$.inputMode&E.vt?function(){if(K(O.k[0].x,O.k[0].y,L.zt.x,L.zt.y)<k&&1===O.k.length)return;if(O.k.push({x:L.zt.x,y:L.zt.y}),O.k.length<2)return;$.inputMode===E.B?T.ot.push(new o(O.k[0].x,O.k[0].y,O.k[1].x,O.k[1].y,!0)):$.inputMode===E.xt&&T.ct.push(new o(O.k[0].x,O.k[0].y,O.k[1].x,O.k[1].y,!0,!1));O=new c}():($.inputMode===E.bt||$.inputMode===E.Ct)&&($.inputMode=$.Ft,$.yt=null,$.kt=null);$.$t.style.backgroundColor=null}),(function(){$.inputMode===E.wt?function(){let t=1;for(let s=0;s<J.length;s++){const i=J[s],n=T.et[s];if(n.tt)continue;t=n.st;const e=t+U(L),o=K(L.Vt.x,L.Vt.y,L.Jt.x,L.Jt.y);i.angle=e,i.R=o}const s=J[0],i=K(s.q.x,s.q.y,s.K.x,s.K.y),n=Math.atan2(s.K.y-s.q.y,s.K.x-s.q.x);$.Et=`${(180*n/Math.PI).toFixed(0)}° | ${i.toFixed(0)}`}():$.inputMode===E.bt?$.kt&&($.kt===$.yt.t?$.yt.j(L.zt.x,L.zt.y,$.yt.i.x,$.yt.i.y):$.yt.j($.yt.t.x,$.yt.t.y,L.zt.x,L.zt.y)):$.inputMode===E.Ct&&function(){if($.yt){const t=L.zt.x-$.yt.u.x,s=L.zt.y-$.yt.u.y;$.yt.j($.yt.t.x+t,$.yt.t.y+s,$.yt.i.x+t,$.yt.i.y+s)}}()}));let O=new c;function U(t){return Math.atan2(-(t.Vt.y-t.Jt.y),-(t.Vt.x-t.Jt.x))}function q(t){t.u.x+t.Z<0&&(t.u.x=F.width-t.Z),t.u.x-t.Z>F.width&&(t.u.x=t.Z),t.u.y+t.Z<0&&(t.u.y=F.height-t.Z),t.u.y-t.Z>F.height&&(t.u.y=t.Z)}function Q(t,s){const i=t.u.x-s.u.x,n=t.u.y-s.u.y;return Math.sqrt(i*i+n*n)<t.Z+s.Z}function R(t,s){const i=t.u.x-s.u.x,n=t.u.y-s.u.y,e=Math.sqrt(i*i+n*n);if(e>t.Z+s.Z)return 0;const o=t.Z+s.Z;return(o-e)/o}function G(t,s){const i=s.u.x-t.u.x,n=s.u.y-t.u.y,e=Math.sqrt(i*i+n*n);if(0===e)return;const o=t.Z+s.Z-e,h=i/e,c=n/e;o>0&&(t.u.x-=o*h*(s.Y/(t.Y+s.Y)),t.u.y-=o*c*(s.Y/(t.Y+s.Y)),s.u.x+=o*h*(t.Y/(t.Y+s.Y)),s.u.y+=o*c*(t.Y/(t.Y+s.Y)));const a=(s.M.x-t.M.x)*h+(s.M.y-t.M.y)*c;if(a>0)return;const l=-2*a/(1/t.Y+1/s.Y);t.M.x-=l/t.Y*h,t.M.y-=l/t.Y*c,s.M.x+=l/s.Y*h,s.M.y+=l/s.Y*c}function K(t,s,i,n){return Math.sqrt(Math.pow(i-t,2)+Math.pow(n-s,2))}function X(t){t.u.x-t.Z<0&&Y(t,t.u.x+F.width,t.u.y),t.u.x+t.Z>F.width&&Y(t,t.u.x-F.width,t.u.y),t.u.y-t.Z<0&&Y(t,t.u.x,t.u.y+F.height),t.u.y+t.Z>F.height&&Y(t,t.u.x,t.u.y-F.height),Y(t,t.u.x,t.u.y)}function Y(t,s,i){A.beginPath(),A.arc(s,i,t.Z,0,2*Math.PI),A.fillStyle=`rgba(255, 255, 255, ${t.alpha})`,A.strokeStyle=`rgba(0, 0, 0, ${t.alpha})`,A.lineWidth=5,A.setLineDash([]),A.closePath(),A.stroke(),A.fill()}function Z(t){A.beginPath(),A.arc(t.u.x,t.u.y,t.Z,0,2*Math.PI),A.fillStyle=t.color,A.fill(),A.closePath()}function _(t){$.Pt.style.backgroundColor=t.backgroundColor,$.Dt.style.color=t.rt,$.Dt.innerText=`${S+1}`,A.clearRect(0,0,F.width,F.height);for(let s=0;s<t.ht.length;s++){Z(t.ht[s])}for(let s=0;s<t.ot.length;s++){t.ot[s].draw(A)}for(let s=0;s<t.ct.length;s++){t.ct[s].draw(A)}$.inputMode&E.vt&&O.k.length>0&&(P.j(O.k[0].x,O.k[0].y,L.zt.x,L.zt.y),P.B=$.inputMode===E.B,P.draw(A));for(let s=0;s<t.et.length;s++){X(t.et[s])}}function tt(){A.clearRect(0,0,F.width,F.height),T.Mt&&(_(H),A.save(),A.beginPath(),A.arc(F.width/2,F.height/2,W,0,2*Math.PI),A.closePath(),A.clip()),_(T),T.Mt&&A.restore();for(let t=0;t<J.length;t++){const s=J[t];T.et[t].tt||st(s)}if(A.fillStyle="white",A.font="30px Arial",$.inputMode&E.gt){let t;if($.inputMode&E.bt?t=$.yt:$.inputMode&E.vt&&(t=O),t&&t.k.length>0){if(1===t.k.length){const s=L.zt.x-t.k[0].x,i=L.zt.y-t.k[0].y,n=180*Math.atan2(i,s)/Math.PI;$.$t.innerText=`${n.toFixed(0)}°`,-0===n&&($.$t.innerText="0")}else{const s=t.k[1].x-t.k[0].x,i=t.k[1].y-t.k[0].y,n=180*Math.atan2(i,s)/Math.PI;$.$t.innerText=`${n.toFixed(0)}°`,-0===n&&($.$t.innerText="0")}$.$t.style.color=wt(...ft(T.ut)),$.$t.style.backgroundColor=T.ut}else $.$t.style.backgroundColor=null}if($.inputMode===E.wt&&J.length>0){let t="";console.log($.At),$.At.length>0&&(t=`<span class="prev-ui-text">${$.At}</span> <br />`),t+=$.Et,$.$t.innerHTML=t,$.$t.style.color=wt(...ft(T.ut)),$.$t.style.backgroundColor=T.ut}else $.$t.style.backgroundColor=null,$.$t.innerText=""}function st(t){it(A,t.q.x,t.q.y,t.K.x,t.K.y);const s=Math.abs(t.q.x-t.K.x),i=Math.abs(t.q.y-t.K.y);let n=t.q.x,e=t.K.x,o=t.q.y,h=t.K.y;t.K.x<0&&(n=t.q.x+F.width,e=n-s),t.K.x>F.width&&(n=t.q.x-F.width,e=n+s),t.K.y<0&&(o=t.q.y+F.height,h=o-i),t.K.y>F.height&&(o=t.q.y-F.height,h=o+i),it(A,n,o,e,h)}function it(t,s,i,n,e){const o=K(s,i,n,e);var h=Math.min(o,20),c=Math.atan2(e-i,n-s);t.fillStyle="#fff",t.strokeStyle="#000",t.lineWidth=5,t.beginPath(),t.moveTo(s,i),t.lineTo(n-h/2*Math.cos(c),e-h/2*Math.sin(c)),t.stroke(),t.strokeStyle="#fff",t.fillStyle="#fff",t.lineWidth=2,t.stroke(),t.beginPath(),t.moveTo(n,e),t.lineTo(n-h*Math.cos(c-Math.PI/6),e-h*Math.sin(c-Math.PI/6)),t.lineTo(n-h*Math.cos(c+Math.PI/6),e-h*Math.sin(c+Math.PI/6)),t.closePath(),t.fill(),t.lineWidth=3,t.strokeStyle="#000",t.stroke(),t.fillStyle="#fff",t.fill(),t.beginPath(),t.moveTo(s,i),t.lineTo(n-h/2*Math.cos(c),e-h/2*Math.sin(c)),t.strokeStyle="#fff",t.lineWidth=2,t.stroke(),t.fillStyle="#fff",t.beginPath(),t.arc(s,i,5,0,2*Math.PI),t.fill(),t.closePath()}function nt(t){for(let s=0;s<T.et.length;s++){const i=T.et[s],n=J[s];i.update(t);for(let t=0;t<T.et.length;t++){if(s===t)continue;const n=T.et[t];i.tt||n.tt||i.alpha<.5||Q(i,n)&&G(i,n)}n&&(n.q.x=i.u.x,n.q.y=i.u.y),$.inputMode===E.Bt&&(q(i),at(i),et(i),ot(i))}if(T.Mt&&(W-=z,W<=0&&ht(S+2)),T.wt)for(let t=0;t<T.et.length;t++){const s=T.et[t];s.tt||(null===$.jt&&($.jt=Date.now()),K(s.M.x,s.M.y,0,0)<y?null===$.jt&&($.jt=Date.now()):$.jt=null,null!==$.jt&&Date.now()-$.jt>1e3&&(Mt(),ct()))}for(let t=0;t<T.ot.length;t++){const s=T.ot[t];s.C&&s.update()}}function et(t){for(let s=0;s<T.ot.length;s++){const i=T.ot[s];if(i.C)continue;const n=r(t,i);if(n){const s=.5*Math.hypot(t.M.x,t.M.y);i.I(s),t.u.x+=n.X.x,t.u.y+=n.X.y;const e=n.axis,o=t.M.x*e.x+t.M.y*e.y;t.M.x-=2*o*e.x,t.M.y-=2*o*e.y}}}function ot(t){t.ns=1;for(let s=0;s<T.ct.length;s++){const i=r(t,T.ct[s]);t.nt=i?.09:0}}function ht(t){S=(t-1)%I.length;const s=(S+1)%I.length;T=I[S],H=I[s],W=V,T.reset(),location.hash=`#/${S+1}`,ct(),$.At="",$.Et=""}function ct(){document.getElementById("js-hit-ball").classList.add("active"),document.getElementById("js-place-wall").classList.remove("active"),document.getElementById("js-place-bump").classList.remove("active"),document.getElementById("js-reset").classList.remove("active"),document.getElementById("js-hit-ball").classList.remove("disabled"),document.getElementById("js-place-wall").classList.remove("disabled"),document.getElementById("js-place-bump").classList.remove("disabled");document.getElementById("js-reset").classList.add("disabled"),$.It.classList.remove("disabled"),$.St.classList.remove("disabled"),0===S&&$.It.classList.add("disabled"),S===I.length-1&&$.St.classList.add("disabled"),Array.from(document.getElementsByClassName("button")).forEach((t=>{let s=T.ut,i=`0 5px ${T.dt}`,n=wt(...ft(T.ut));t.classList.contains("disabled")?(t.style.backgroundColor=null,t.style.boxShadow=null,t.style.color=null):(t.style.backgroundColor=s,t.style.boxShadow=i,t.style.color=n)})),$.jt=null,$.yt=null,$.kt=null,$.inputMode=E.wt,F.style.cursor="crosshair"}function at(t){t.it=!1;for(let s=0;s<T.ht.length;s++){const i=T.ht[s],n=i.u.x-t.u.x,e=i.u.y-t.u.y,o=Math.sqrt(n*n+e*e),h=Math.sqrt(t.M.x*t.M.x+t.M.y*t.M.y);if(o<=i.Z-t.Z&&h<j)t.tt=i,t.it=!0;else if(Q(t,i)){const s=.2*R(t,i),h=s*n/o,c=s*e/o;t.M.x+=h,t.M.y+=c,t.alpha-=.01,t.alpha=Math.max(t.alpha,0),t.it=!0}}t.it||(t.alpha=1)}const lt=1e3/60;let rt=0,ut=0;function dt(){const t=window.location.hash.substring(2);return 0===t.length?1:parseInt(t,10)}function ft(t){var s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return s?[parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16)]:null}function wt(t,s,i){const n=function(t,s,i){return.299*t+.587*s+.114*i}(t,s,i);return n>128?"black":"white"}function Mt(){$.At=$.Et,T.reset()}!function t(s){const i=s-ut;for(ut=s,rt+=i;rt>=lt;)nt(lt),rt-=lt;tt(),requestAnimationFrame(t)}(0),document.addEventListener("DOMContentLoaded",(()=>{ht(dt()),document.getElementById("js-hit-ball").click()})),window.addEventListener("hashchange",(()=>{ht(dt())})),window.addEventListener("mousemove",(t=>{const s=F.getBoundingClientRect();let i="crosshair";for(let n=0;n<T.ot.length;n++){let e=t.clientX-s.left,o=t.clientY-s.top;const h=T.ot[n];e/=D(),o/=D(),h.L(e,o)?i="pointer":(h.J(e,o)||h.T(e,o))&&(i="grab")}for(let n=0;n<T.ct.length;n++){let e=t.clientX-s.left,o=t.clientY-s.top;const h=T.ct[n];e/=D(),o/=D(),h.L(e,o)?i="pointer":(h.J(e,o)||h.T(e,o))&&(i="grab")}$.inputMode===E.Bt&&(i="not-allowed"),F.style.cursor=i}))})();